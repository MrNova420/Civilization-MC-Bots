<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BetterBender 2.0 Dashboard</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: #0f172a;
      color: #e2e8f0;
      padding: 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    h1 {
      color: #38bdf8;
      margin-bottom: 10px;
    }
    
    .status-bar {
      background: #1e293b;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .status-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .status-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ef4444;
    }
    
    .status-dot.connected {
      background: #22c55e;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .card {
      background: #1e293b;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #334155;
    }
    
    .card h2 {
      color: #38bdf8;
      margin-bottom: 15px;
      font-size: 1.2em;
    }
    
    button {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.2s;
    }
    
    button:hover {
      background: #2563eb;
    }
    
    button.danger {
      background: #ef4444;
    }
    
    button.danger:hover {
      background: #dc2626;
    }
    
    button.success {
      background: #22c55e;
    }
    
    button.success:hover {
      background: #16a34a;
    }
    
    button:disabled {
      background: #475569;
      cursor: not-allowed;
    }
    
    input, textarea, select {
      width: 100%;
      padding: 10px;
      background: #0f172a;
      border: 1px solid #334155;
      border-radius: 6px;
      color: #e2e8f0;
      margin-bottom: 10px;
      font-family: inherit;
    }
    
    .button-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .metrics {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
    
    .metric {
      background: #0f172a;
      padding: 10px;
      border-radius: 6px;
    }
    
    .metric-label {
      font-size: 0.85em;
      color: #94a3b8;
    }
    
    .metric-value {
      font-size: 1.3em;
      font-weight: bold;
      color: #38bdf8;
    }
    
    .log-container {
      background: #0f172a;
      padding: 15px;
      border-radius: 6px;
      height: 300px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.85em;
    }
    
    .log-entry {
      padding: 4px 0;
      border-bottom: 1px solid #1e293b;
    }
    
    .auth-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .auth-box {
      background: #1e293b;
      padding: 30px;
      border-radius: 12px;
      max-width: 400px;
      width: 90%;
    }
    
    .mode-selector {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    
    .mode-selector button {
      flex: 1;
    }
    
    .mode-selector button.active {
      background: #22c55e;
    }
  </style>
</head>
<body>
  <div id="authOverlay" class="auth-overlay">
    <div class="auth-box">
      <h2>Dashboard Authentication</h2>
      <p style="margin: 15px 0; color: #94a3b8;">Enter your admin token to access the dashboard</p>
      <input type="password" id="tokenInput" placeholder="Admin Token" />
      <button onclick="authenticate()" class="success">Login</button>
      <div id="authError" style="color: #ef4444; margin-top: 10px;"></div>
    </div>
  </div>
  
  <div class="container">
    <h1>ðŸ¤– BetterBender 2.0</h1>
    <p style="color: #94a3b8; margin-bottom: 20px;">Autonomous Minecraft Bot Dashboard</p>
    
    <div class="status-bar">
      <div class="status-item">
        <div id="statusDot" class="status-dot"></div>
        <span id="statusText">Disconnected</span>
      </div>
      <div class="status-item">
        <strong>Mode:</strong> <span id="currentMode">-</span>
      </div>
      <div class="status-item">
        <strong>Health:</strong> <span id="health">-</span>
      </div>
      <div class="status-item">
        <strong>Food:</strong> <span id="food">-</span>
      </div>
      <div class="status-item">
        <strong>Position:</strong> <span id="position">-</span>
      </div>
    </div>
    
    <div class="grid">
      <div class="card">
        <h2>Bot Control</h2>
        <div class="button-group">
          <button onclick="startBot()" class="success">Start Bot</button>
          <button onclick="stopBot()" class="danger">Stop Bot</button>
        </div>
        <h3 style="margin-top: 20px; margin-bottom: 10px; color: #94a3b8;">Mode</h3>
        <div class="mode-selector">
          <button id="modeAfk" onclick="switchMode('afk')">AFK Mode</button>
          <button id="modePlayer" onclick="switchMode('player')">Player Mode</button>
        </div>
      </div>
      
      <div class="card">
        <h2>System Health</h2>
        <div class="metrics">
          <div class="metric">
            <div class="metric-label">CPU Usage</div>
            <div class="metric-value" id="cpu">-</div>
          </div>
          <div class="metric">
            <div class="metric-label">Memory (MB)</div>
            <div class="metric-value" id="memory">-</div>
          </div>
          <div class="metric">
            <div class="metric-label">Temperature</div>
            <div class="metric-value" id="temperature">-</div>
          </div>
          <div class="metric">
            <div class="metric-label">Throttled</div>
            <div class="metric-value" id="throttled">-</div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <h2>Chat</h2>
        <input type="text" id="chatInput" placeholder="Type a message..." />
        <button onclick="sendChat()">Send</button>
      </div>
      
      <div class="card">
        <h2>Quick Commands</h2>
        <input type="text" id="commandInput" placeholder="Enter command..." />
        <button onclick="executeCommand()">Execute</button>
        <div id="commandResult" style="margin-top: 10px; color: #94a3b8;"></div>
      </div>
    </div>
    
    <div class="card">
      <h2>Live Logs</h2>
      <div class="log-container" id="logContainer"></div>
    </div>
  </div>
  
  <script src="/socket.io/socket.io.js"></script>
  <script>
    let socket = null;
    let authenticated = false;
    const logs = [];
    
    function authenticate() {
      const token = document.getElementById('tokenInput').value;
      
      if (!token) {
        document.getElementById('authError').textContent = 'Please enter a token';
        return;
      }
      
      socket = io();
      
      socket.on('connect', () => {
        socket.emit('authenticate', token);
      });
      
      socket.on('authenticated', (data) => {
        if (data.success) {
          authenticated = true;
          document.getElementById('authOverlay').style.display = 'none';
          setupSocketListeners();
          addLog('Dashboard connected');
        } else {
          document.getElementById('authError').textContent = 'Invalid token';
        }
      });
    }
    
    function setupSocketListeners() {
      socket.on('status_update', (data) => {
        updateStatus(data);
      });
      
      socket.on('bot_status', (data) => {
        updateConnectionStatus(data.running);
      });
      
      socket.on('mode_changed', (data) => {
        updateMode(data.mode);
      });
      
      socket.on('chat_message', (data) => {
        addLog(`[CHAT] ${data.message}`);
      });
      
      socket.on('command_result', (data) => {
        document.getElementById('commandResult').textContent = 
          data.success ? `âœ“ ${data.message || 'Success'}` : `âœ— ${data.error || 'Failed'}`;
      });
    }
    
    function updateStatus(data) {
      document.getElementById('currentMode').textContent = data.mode || '-';
      document.getElementById('health').textContent = data.health || '-';
      document.getElementById('food').textContent = data.food || '-';
      
      if (data.position) {
        const pos = `(${Math.round(data.position.x)}, ${Math.round(data.position.y)}, ${Math.round(data.position.z)})`;
        document.getElementById('position').textContent = pos;
      }
      
      if (data.safety) {
        document.getElementById('cpu').textContent = `${data.safety.cpu || 0}%`;
        document.getElementById('memory').textContent = data.safety.memory || 0;
        document.getElementById('temperature').textContent = 
          data.safety.temperature ? `${data.safety.temperature}Â°C` : 'N/A';
        document.getElementById('throttled').textContent = 
          data.safety.throttled ? 'YES' : 'No';
      }
      
      updateConnectionStatus(data.connected);
      updateMode(data.mode);
    }
    
    function updateConnectionStatus(connected) {
      const dot = document.getElementById('statusDot');
      const text = document.getElementById('statusText');
      
      if (connected) {
        dot.classList.add('connected');
        text.textContent = 'Connected';
      } else {
        dot.classList.remove('connected');
        text.textContent = 'Disconnected';
      }
    }
    
    function updateMode(mode) {
      document.getElementById('modeAfk').classList.remove('active');
      document.getElementById('modePlayer').classList.remove('active');
      
      if (mode === 'afk') {
        document.getElementById('modeAfk').classList.add('active');
      } else if (mode === 'player') {
        document.getElementById('modePlayer').classList.add('active');
      }
    }
    
    function addLog(message) {
      const timestamp = new Date().toLocaleTimeString();
      logs.push(`[${timestamp}] ${message}`);
      
      if (logs.length > 100) {
        logs.shift();
      }
      
      const container = document.getElementById('logContainer');
      container.innerHTML = logs.map(log => 
        `<div class="log-entry">${log}</div>`
      ).join('');
      container.scrollTop = container.scrollHeight;
    }
    
    function startBot() {
      socket.emit('start_bot');
      addLog('Starting bot...');
    }
    
    function stopBot() {
      socket.emit('stop_bot');
      addLog('Stopping bot...');
    }
    
    function switchMode(mode) {
      socket.emit('switch_mode', { mode });
      addLog(`Switching to ${mode} mode...`);
    }
    
    function sendChat() {
      const input = document.getElementById('chatInput');
      const message = input.value.trim();
      
      if (message) {
        socket.emit('send_chat', { message });
        addLog(`[SENT] ${message}`);
        input.value = '';
      }
    }
    
    function executeCommand() {
      const input = document.getElementById('commandInput');
      const command = input.value.trim();
      
      if (command) {
        socket.emit('execute_command', { command });
        addLog(`[CMD] ${command}`);
        input.value = '';
      }
    }
    
    document.getElementById('chatInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendChat();
    });
    
    document.getElementById('commandInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') executeCommand();
    });
    
    document.getElementById('tokenInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') authenticate();
    });
  </script>
</body>
</html>
